#!/bin/bash

#### Install home directory files
####   Usage: ${PI_INVOKER} <username>

# Install a user's home directory from pre-supplied data, taking care
# to set the permissions on .ssh/ correctly.
installHome() {
    local user="${1:?}"
    local home="/home/${user}"
    local src="${PI_DATA}/${home}"
    local pending="${PENDING}/${home}"

    verbose "Installing user files for ${user}"
    cp -a "${src}" "${home}"
    cp -a "${src}/.ssh" "${home}/.ssh"
    find "${pending}/.ssh" -type d -exec chmod 700 {} \;
    find "${pending}/.ssh" -type f -exec chmod 600 {} \;
}
